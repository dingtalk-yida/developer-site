---
title: è‡ªå®šä¹‰é¡µé¢å®ç°åº”ç”¨å…¨æµç¨‹æ•ˆç‡ç›‘æ§
order: 10
---

## ä½¿ç”¨èƒŒæ™¯

åœ¨[è‡ªå®šä¹‰é¡µé¢æŸ¥çœ‹æµç¨‹æ•ˆç‡](https://www.yuque.com/yida/subject/rl2bye)æ–‡æ¡£ä¸­å®ç°äº†å°†ä¸€ä¸ªæµç¨‹å†…çš„å®¡æ‰¹æ•°æ®å±•ç¤ºåœ¨è¡¨æ ¼ç»„ä»¶å½“ä¸­ï¼Œé‚£ä¹ˆå¦‚ä½•å®ç°å½“å‰åº”ç”¨æ‰€æœ‰æµç¨‹çš„æ•ˆç‡ç›‘æ§å‘¢ã€‚æ­¤æ–‡æ¡£ä»‹ç»å¦‚ä½•å®ç°å•åº”ç”¨å…¨æµç¨‹æ•ˆç‡ç›‘æ§ã€‚

## æ•ˆæœå±•ç¤º

![å®ç°æ•ˆæœ](https://img.alicdn.com/imgextra/i3/O1CN015eMR6a1GgCaCZbNmK_!!6000000000651-1-tps-1385-717.gif)

## è§†é¢‘æ•™ç¨‹

<video width="100%" controls>
  <source src="https://cloud.video.taobao.com/play/u/1775663/p/1/d/hd/e/6/t/1/332142170749.mp4?auth_key=YXBwX2tleT04MDAwMDAwMTImYXV0aF9pbmZvPXsidGltZXN0YW1wRW5jcnlwdGVkIjoiODU5ZmUwN2RkY2ZmNDRkMGQ5MDgzN2JmMzQ1YTU4NzUifSZkdXJhdGlvbj0mdGltZXN0YW1wPTE2NDczMTA0OTA="></source>
</video>

## æ“ä½œæ­¥éª¤

### æ­¥éª¤ä¸€ï¼šåˆ›å»ºæµç¨‹é¡µé¢

åˆ›å»º 2 ä¸ªæµç¨‹é¡µé¢ï¼Œåˆ†åˆ«é…ç½®é¡µé¢æ‰€éœ€ç»„ä»¶å’Œæµç¨‹å®¡æ‰¹èŠ‚ç‚¹ä¿¡æ¯ï¼Œå¹¶å½•å…¥ä¸€äº›æµ‹è¯•æ•°æ®ã€‚ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰
![æµç¨‹](https://img.alicdn.com/imgextra/i1/O1CN016VFSFk28CQ4mTvy3g_!!6000000007896-2-tps-1439-806.png)
![æµç¨‹2](https://img.alicdn.com/imgextra/i2/O1CN01b8DVc31X1l4rNB1qt_!!6000000002864-2-tps-1386-701.png)

### æ­¥éª¤äºŒï¼šåˆ›å»ºæ•°æ®åº•è¡¨

ä½œç”¨ï¼šå­˜å‚¨åº”ç”¨å†…æ‰€éœ€æŸ¥çœ‹çš„æµç¨‹è¡¨å•åç§°å’Œæµç¨‹è¡¨å• formUuidï¼Œåç»­ä¼šå°†è¡¨å•å†…çš„æ•°æ®åœ¨è‡ªå®šä¹‰é¡µé¢è·å–ï¼Œæ”¾åœ¨ä¸‹æ‹‰å•é€‰ä¸­ç”¨ä½œé€‰æ‹©æŸ¥çœ‹æµç¨‹é¡µé¢å®¡æ‰¹æ•°æ®ã€‚ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰
![åº•è¡¨](https://img.alicdn.com/imgextra/i2/O1CN01LCoSPY1Dbfovjxl0u_!!6000000000235-2-tps-1267-806.png)

### æ­¥éª¤ä¸‰ï¼šåˆ›å»ºå¹¶é…ç½®è‡ªå®šä¹‰é¡µé¢

** (1) é¡µé¢è®¾è®¡ **

- ã€Œä¸‹æ‹‰å•é€‰ã€ï¼šé…ç½®é€‰é¡¹ï¼Œæ˜¾ç¤ºå€¼é…ç½®æµç¨‹è¡¨å•åç§°ï¼Œé€‰é¡¹å€¼é…ç½®æµç¨‹è¡¨å• formUuidã€‚
- ã€Œè¡¨æ ¼ç»„ä»¶ã€ï¼šä¸»è¦é…ç½®æ“ä½œåˆ—ä¸­çš„æ“ä½œè¿›åº¦é€‰é¡¹ï¼Œæ§åˆ¶è¿›åº¦æŒ‡ç¤ºå™¨çš„è¿›åº¦ç™¾åˆ†æ¯”ï¼Œå…¶ä½™é…ç½®å¯ä»¥å‚è€ƒæ–‡æ¡£ è‡ªå®šä¹‰é¡µé¢æŸ¥çœ‹æµç¨‹æ•ˆç‡ã€‚
- ã€Œè¿›åº¦æŒ‡ç¤ºå™¨ç»„ä»¶ã€ï¼šç™¾åˆ†æ¯”å±æ€§ç»‘å®šå˜é‡æ•°æ®æºï¼Œå¹¶å…³é—­è‡ªåŠ¨æ¸²æŸ“ï¼Œæ ¹æ®å˜é‡æ•°æ®æºæ§åˆ¶æ¸²æŸ“å’Œç™¾åˆ†æ¯”ã€‚
  ![è‡ªå®šä¹‰é¡µé¢](https://img.alicdn.com/imgextra/i3/O1CN01I5P7Qm1kIKPSgJkDS_!!6000000004660-2-tps-1331-563.png)

** ï¼ˆ2ï¼‰ å®šä¹‰è¿œç¨‹æ•°æ®æº **

ä¸ºäº†å®æ—¶è·å–æµç¨‹çš„ç›‘æ§æƒ…å†µï¼Œä¼šå…ˆè°ƒç”¨ [æœç´¢å®ä¾‹ ID](https://www.yuque.com/yida/support/aql605#HML0n) çš„æ¥å£ï¼Œç­›é€‰å®Œæˆå¯¹åº”çš„æµç¨‹åé€šè¿‡ [è·å–å®¡æ‰¹è®°å½•](https://www.yuque.com/yida/support/aql605#g72uF) çš„æ¥å£ å°†æ•°æ®å®¡æ‰¹èŠ‚ç‚¹çš„åŠ¨ä½œå’Œå®¡æ‰¹æ—¶é—´ç­‰æ•°æ®è·å–å‡ºæ¥ï¼Œåœ¨è‡ªå®šä¹‰é¡µé¢è¿›è¡Œå±•ç¤ºã€‚ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰
![è¿œç¨‹æ•°æ®æº](https://img.alicdn.com/imgextra/i1/O1CN01zvoSn022jUzY0bAy4_!!6000000007156-2-tps-1439-803.png)

> ** è¯´æ˜ï¼š**
>
> - æ•°æ®æºå…³é—­è‡ªåŠ¨åŠ è½½ï¼Œåç»­ä¸ºäº†å®ç°åˆ†é¡µå’Œæ€»è®¡çš„æ•ˆæœï¼Œåœ¨è°ƒç”¨æ•°æ®æºåä½¿ç”¨äº†æ•°æ®å¤„ç†ï¼Œè¿”å›å®ä¾‹ IDï¼Œæ€»æ¡æ•°å’Œå½“å‰é¡µç ã€‚
> - ä¸‹è¿°ä»£ç å¯ç›´æ¥å¤åˆ¶åœ¨è·å–å®ä¾‹ ID æ¥å£çš„ didfetch æ•°æ®å¤„ç†å†…ã€‚

```JavaScript
function didFetch(content) {
  //è¿”å›å®ä¾‹ID,æ€»æ¡æ•°å’Œå½“å‰é¡µç 
  let result = {
    processInstanceId: content.data,
    totalCount: content.totalCount,
    currentPage: content.currentPage,
  }
  return result; // é‡è¦ï¼Œéœ€è¿”å› result
}
```

> ** æ‰©å±•é˜…è¯» ** ï¼šç»™ä¸‹æ‹‰ç»„ä»¶é€‰é¡¹èµ‹å€¼çš„ä¸¤ç§æ–¹æ³•
>
> ** æ–¹æ³•ä¸€ï¼š** é…ç½®è¿œç¨‹æ•°æ®æº [æœç´¢è¡¨å•å®ä¾‹è¯¦æƒ…åˆ—è¡¨] è·å–åº•è¡¨å†…çš„æ•°æ®(åº•è¡¨çš„æ•°æ®å‚è€ƒ 3.2 æ­¥éª¤)ï¼Œæ‰“å¼€è‡ªåŠ¨åŠ è½½ï¼Œåœ¨ didfetch æ•°æ®å¤„ç†ä¸­å¤„ç†æˆä¸‹æ‹‰å•é€‰çš„é€‰é¡¹æ ¼å¼è¿”å›ï¼Œä¸‹æ‹‰å•é€‰çš„é€‰é¡¹å±æ€§ç»‘å®šè¿œç¨‹æ•°æ®æºï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ã€‚
> ![æ–¹æ³•ä¸€](https://img.alicdn.com/imgextra/i3/O1CN011BstTw1LGA8lNVh7X_!!6000000001271-2-tps-1438-806.png)
> ä¸‹è¿°ä»£ç å¯ç›´æ¥å¤åˆ¶ didfetch æ•°æ®å¤„ç†å†…ï¼Œ** æ³¨æ„ï¼šéœ€è¦æ›¿æ¢ç»„ä»¶çš„å”¯ä¸€æ ‡è¯†ã€‚ **
>
> ```JavaScript
> function didFetch(content) {
>  //å¤„ç†æˆä¸‹æ‹‰å•é€‰çš„é€‰é¡¹å±æ€§æ•°æ®æ ¼å¼
> const datasource = [];
> content.data.map((item) => {
>  let arr = {
>     //textå­˜å‚¨è¡¨å•åç§°ï¼Œvalueå­˜å‚¨è¡¨å•formUuidï¼Œå”¯ä¸€æ ‡è¯†æ›´æ”¹æˆåº•è¡¨å†…ç›¸å¯¹åº”çš„å”¯ä¸€æ ‡è¯†
>     text: item.formData.textField_kto1kwz0,
>     value: item.formData.textField_kto1kwz2
>   }
>   datasource.push(arr)
> })
> return datasource; // é‡è¦ï¼Œéœ€è¿”å› datasource
> }
> ```
>
> ** æ–¹æ³•äºŒï¼š**
> å¯ä»¥ç›´æ¥åœ¨ä¸‹æ‹‰å•é€‰çš„è‡ªå®šä¹‰é€‰é¡¹ä¸­é…ç½®æ˜¾ç¤ºå€¼å’Œé€‰é¡¹å€¼ä¸ºæµç¨‹è¡¨å•åç§°å’Œæµç¨‹è¡¨å• formUuid ã€‚ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰
> ![æ–¹æ³•äºŒ](https://img.alicdn.com/imgextra/i1/O1CN01IVqcQI1FxmA8Kr5JJ_!!6000000000554-2-tps-1251-437.png)

** ï¼ˆ3ï¼‰ å®šä¹‰å˜é‡æ•°æ®æº **

ç”±äºå¯¹è¿”å›çš„æ•°æ®åšäº†è¾ƒä¸ºå¤æ‚çš„æ ¼å¼å¤„ç†ï¼Œæ‰€ä»¥å®šä¹‰å˜é‡æ•°æ®æº time å’Œ datasï¼Œè¡¨æ ¼ç»„ä»¶ç»‘å®š datas å˜é‡æ•°æ®æºã€‚ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰
![å˜é‡æ•°æ®æº](https://img.alicdn.com/imgextra/i1/O1CN01yVaAPp1WtyLMeBpgA_!!6000000002847-2-tps-1439-767.png)
percent å’Œ condition åˆ†åˆ«æ§åˆ¶è¿›åº¦æŒ‡ç¤ºå™¨ç»„ä»¶çš„ç™¾åˆ†æ¯”å’Œæ˜¯å¦æ¸²æŸ“å±æ€§ã€‚ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰
![æ•°æ®æº](https://img.alicdn.com/imgextra/i2/O1CN01bYCUFN1alVU5NEPAk_!!6000000003370-2-tps-1120-686.png)
** ï¼ˆ4ï¼‰ ä¸‹æ‹‰ç»„ä»¶ç»‘å®šåŠ¨ä½œè§¦å‘è°ƒç”¨ **
![ç»‘å®šåŠ¨ä½œ](https://img.alicdn.com/imgextra/i4/O1CN01OXh36H1opzzS9ATxm_!!6000000005275-2-tps-1438-807.png)
![æ›´æ”¹æ•°æ®å­—æ®µåç§°](https://img.alicdn.com/imgextra/i4/O1CN01mWZoMU1gHdLSsKJuT_!!6000000004117-2-tps-1392-806.png)
é€šè¿‡ API æ–¹æ³•è·å–åˆ°ä¸‹æ‹‰ç»„ä»¶çš„ value å€¼ï¼Œå®šä¹‰è¯·æ±‚å‚æ•°ï¼Œå°† value å€¼ä¹Ÿå°±æ˜¯è¡¨å•çš„ formUuid å½“è¯·æ±‚å‚æ•°å®šä¹‰ï¼Œæœ€ç»ˆåœ¨ getInstanceIds è¿œç¨‹æ•°æ®æºä¸­ä¼ å…¥å‚æ•°å¾—åˆ°è¯¥é¡µé¢çš„å®¡æ‰¹ä¿¡æ¯ã€‚

> ** è¯´æ˜ï¼š **ä¸‹è¿°ä»£ç å¯ç›´æ¥å¤åˆ¶ JS é¢æ¿å†…ï¼Œæ³¨æ„ï¼šéœ€è¦æ›¿æ¢ä¸‹æ‹‰ç»„ä»¶çš„å”¯ä¸€æ ‡è¯†ã€‚

```JavaScript
export function onChange({value, actionType, item}) {
  //æ§åˆ¶åˆ‡æ¢æ—¶è¿›åº¦æ¡ç»„ä»¶ä¸æ¸²æŸ“ï¼Œè¿›åº¦ç™¾åˆ†æ¯”ä¸º0
  this.setState({
    condition: false,
    percent: 0
  })
   //æ¸…ç©ºdataså˜é‡æ•°æ®æº
  this.setState({
    datas : []
  })
  //é€šè¿‡APIæ–¹æ³•è·å–åˆ°ä¸‹æ‹‰ç»„ä»¶çš„valueå€¼ï¼Œä¹Ÿå°±æ˜¯formUuid
  const uuid = this.$('select_kto1v6f2').getValue();
  let newvalue = [];
  //å®šä¹‰è¯·æ±‚å‚æ•°
  const param_uuid = {
    formUuid: uuid
  }
  //åœ¨getInstanceIdsè¿œç¨‹æ•°æ®æºä¸­æºå¸¦å‚æ•°è®¡ç®—å‡ºé€‰æ‹©åˆ°çš„é¡µé¢å®¡æ‰¹ä¿¡æ¯
  this.dataSourceMap.getInstanceIds.load(param_uuid).then((response) => {
    let res = response.processInstanceId
    for (let i = 0; i < res.length; i++) {
      const params = {
        processInstanceId: res[i],
      }
      this.dataSourceMap.getOperationRecords.load(params).then((content) => {
        //å­˜å‚¨æ ‘å½¢è¡¨æ ¼å†…çš„childrenæ ¼å¼ï¼Œè¯¦æƒ…è¡¨æ ¼æ ¼å¼å¯ä»¥ç‚¹å‡»æŸ¥çœ‹è¡¨æ ¼æ•°æ®æºå±æ€§ä¸­çš„ç¼–è¾‘ä»£ç æˆ–å‚è€ƒæ–‡æ¡£ï¼šhttps://www.aliwork.com/developer/table-pc#tree
        const children = [];
        //å¾ªç¯ä¸€ä¸ªæµç¨‹ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹çš„å®¡æ‰¹è®°å½•ï¼Œæœ€ç»ˆå°†åˆ¤æ–­å¥½çš„æ•°æ®æ ¼å¼pushåˆ°childrenä¸­
        for (let item = 0; item < content.length; item++) {
          //åˆ¤æ–­å½“å®¡æ‰¹çŠ¶æ€æ˜¯nextæˆ–submitæˆ–doingæ—¶æ²¡æœ‰æœ¬èŠ‚ç‚¹çš„å®¡æ‰¹æ—¶é—´ï¼Œæ‰€ä»¥ä¸è®¡ç®—æœ¬èŠ‚ç‚¹åˆ°ä¸Šä¸€ä¸ªèŠ‚ç‚¹æ‰€ç”¨å®¡æ‰¹æ—¶é•¿
          if (content[item].actionExt === "next" || content[item].actionExt === "submit" || content[item].actionExt === "doing") {
            //é‡æ–°æäº¤çš„å®¡æ‰¹çŠ¶æ€æ˜¯submitï¼Œè¿™é‡Œå¯¹å®ƒä½œåˆ¤æ–­è®¡ç®—äº†å®¡æ‰¹æ—¶é•¿
            if (content[item].showName === "é‡æ–°æäº¤") {
              this.setState({
                time: timeshow(content[item].operateTime, content[item - 1].operateTime)
              })
              let children_data = {
                actionExt: content[item].actionExt,
                active: content[item].showName,
                active_name: content[item].operatorName,
                active_time: content[item].operateTime,
                time: state.time,
                onlyid: params.processInstanceId
              }
              children.push(children_data);
            } else {
              //æ²¡æœ‰æœ¬èŠ‚ç‚¹å®¡æ‰¹æ—¶é—´çš„ä¸åŠ time
              let children_data = {
                actionExt: content[item].actionExt,
                active: content[item].showName,
                active_name: content[item].operatorName,
                active_time: content[item].operateTime,
                onlyid: params.processInstanceId
              }
              children.push(children_data);
            }
          } else {
            this.setState({
              time: timeshow(content[item].operateTime, content[item - 1].operateTime)
            })
            let children_data = {
              actionExt: content[item].actionExt,
              active: content[item].showName,
              active_name: content[item].operatorName,
              active_time: content[item].operateTime,
              time: state.time,
              onlyid: params.processInstanceId
            }
            children.push(children_data);
          }
        }

        //åˆ¤æ–­æ˜¯HISTORYç±»å‹æ—¶ï¼Œè®¡ç®—æ€»å®¡æ‰¹æ—¶é•¿ï¼Œæœ€ç»ˆå®¡æ‰¹æ—¶é—´-æäº¤æ—¶é—´
        if (content[content.length - 1].type === "HISTORY") {
          const num_end = content[content.length - 1].operateTime;
          const num_start = content[0].operateTime;

          this.setState({
            time: timeshow(num_end, num_start)
          })

          let data = {
            //å‘èµ·äººå’Œå‘èµ·æ—¶é—´æ˜¯content[0]é‡Œçš„æ•°æ®ï¼Œå…¶ä½™æ˜¯è·å–çš„æœ€åä¸€æ¡æ•°æ®
            create_name: content[0].operatorName,
            create_time: content[0].operateTime,
            actionExt: "Completed",
            active: content[content.length - 1].showName + "(å·²å®Œæˆ)",
            active_name: content[content.length - 1].operatorName + "(å·²å®Œæˆ)",
            active_time: content[content.length - 1].operateTime,
            action: content[content.length - 1].actionExt,
            time: state.time,
            children: children,
            onlyid: params.processInstanceId
          }
          newvalue.push(data);
        }
        //å¾ªç¯è·å–æ•°æ®åˆ—çš„æ•°æ®ï¼Œå½“å‰çš„å®¡æ‰¹èŠ‚ç‚¹æ•°æ®pushåœ¨æ•°æ®åˆ—ä¸­
        for (let j = 0; j < content.length; j++) {
          if (content[j].type === "TODO") {
            let data = {
              //å‘èµ·äººå’Œå‘èµ·æ—¶é—´æ˜¯content[0]é‡Œçš„æ•°æ®ï¼Œå…¶ä½™å˜æˆTODOç±»å‹æ—¶çš„æ•°æ®ä¹Ÿå°±æ˜¯è¿›è¡Œä¸­çš„é‚£æ¡æ•°æ®
              create_name: content[0].operatorName,
              create_time: content[0].operateTime,
              actionExt: content[j].actionExt,
              active: content[j].showName + "ï¼ˆå½“å‰ï¼‰",
              active_name: content[j].operatorName + "ï¼ˆå½“å‰ï¼‰",
              active_time: content[j].activeTime,
              children: children,
              onlyid: params.processInstanceId,
            }
            newvalue.push(data);
          }
        }

        //æºå¸¦æ€»è®¡æ¡æ•°å’Œæ•°æ®åˆ—çš„å€¼èµ‹å€¼ç»™dataså˜é‡æ•°æ®æº
        let result = {
          data: newvalue,
          totalCount: response.totalCount,
        }
        this.setState({
          datas: result
        })

      })
    }
  })
}

//timeshowæ–¹æ³•ï¼Œä¼ å…¥ç»“æŸæ—¶é—´å’Œå¼€å§‹æ—¶é—´è®¡ç®—æ—¶é—´å·®
export function timeshow(num_end, num_start) {
  const num = (num_end - num_start) / 1000;
  const day = Math.floor(num / 86400) + "d ";
  const hour = Math.floor((num % 86400) / 3600) + "h ";
  const min = Math.floor(((num % 86400) % 3600) / 60) + "min ";
  const s = Math.floor(((num % 86400) % 3600) % 60) + "s ";
  if (day == "0d ") {
    //åˆ¤æ–­å½“å¤©æ•°ç­‰äº0dæ—¶
    if (hour == "0h ") {
      //åœ¨å½“å¤©æ•°ç­‰äº0dæ—¶ï¼Œç»§ç»­åˆ¤æ–­å½“å°æ—¶ç­‰äº0hæ—¶
      if (min == "0min ") {
        //åœ¨å½“å¤©æ•°ç­‰äº0dæ—¶,å½“å°æ—¶ç­‰äº0hæ—¶,ç»§ç»­åˆ¤æ–­åˆ†ç­‰äº0æ—¶
        //è¿”å›ç§’
        return `${s}`
      } else {
        //minä¸ç­‰äº0æ—¶ï¼Œåˆ™å°†åˆ†é’Ÿå’Œç§’è¿”å›
        return `${min}${s}`
      }
    } else {
      //å¤©æ•°ç­‰äº0dï¼Œå°æ—¶ä¸ç­‰äº0hæ—¶ï¼Œè¿”å›å°æ—¶åˆ†é’Ÿ
      return `${hour}${min}${s}`
    }
  } else {
    //å½“å¤©æ•°ä¸ç­‰äº0dæ—¶ï¼Œå°†å¤©æ•°å°æ—¶åˆ†é’Ÿæ‹¼æ¥ä¸€èµ·è¿”å›
    return `${day}${hour}${min}${s}`
  }
}
```

![æ•ˆæœæ¼”ç¤º](https://img.alicdn.com/imgextra/i2/O1CN01qy7JxR1cx4ijY7Okk_!!6000000003666-1-tps-1256-729.gif)

** ï¼ˆ5ï¼‰ è®¾ç½®æ“ä½œåˆ—çš„æŸ¥çœ‹è¿›åº¦ **

è®¾ç½®è¡¨æ ¼çš„æ“ä½œåˆ— >> æ·»åŠ åä¸ºæŸ¥çœ‹è¿›åº¦çš„æ“ä½œé¡¹ >> ç‚¹å‡»ç¼–è¾‘ >> ç»‘å®šå›è°ƒåŠ¨ä½œ >> ç»‘å®šå®šåˆ¶æ¸²æŸ“ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰

![è®¾ç½®æ“ä½œåˆ—](https://img.alicdn.com/imgextra/i3/O1CN01dx4iDl24RksN8YVpE_!!6000000007388-2-tps-1439-791.png)

> ** è¯´æ˜ï¼š**
>
> ä¸‹è¿°ä»£ç å¯ç›´æ¥å¤åˆ¶ JS é¢æ¿å†…ï¼Œç»‘å®šçš„åç§°å¯ä»¥è‡ªè¡Œé…ç½®ï¼Œè¿™é‡Œå®šä¹‰åç§°ä¸ºï¼š
>
> - ç»‘å®šçš„å›è°ƒå‡½æ•°åç§°æ˜¯ onActionClick2ã€‚
> - å®šåˆ¶æ¸²æŸ“åç§°æ˜¯ actionRender1ã€‚

```JavaScript
export function onActionClick2(rowData) {
  //å¦‚æœå®¡æ‰¹å®Œæˆäº†ï¼Œè¿›åº¦æ¡æ¸²æŸ“å¹¶ä¸”ç™¾åˆ†æ¯”ä¸º100
  if (rowData.actionExt == "Completed"){
    this.setState({
      condition:true,
      percent: 100
    })
  }else{
    //å®¡æ‰¹æœªå®Œæˆï¼Œéå†å®¡æ‰¹èŠ‚ç‚¹ä¿¡æ¯ï¼Œå¦‚æœå®¡æ‰¹èŠ‚ç‚¹å·²å®Œæˆ num åŠ ä¸€ï¼Œæœ€ç»ˆç”¨ num å’Œå®¡æ‰¹èŠ‚ç‚¹çš„æ€»é•¿åº¦è®¡ç®—å‡ºç™¾åˆ†æ¯”
    let child = rowData.children;
    let num = 0;
    for (let p = 0; p < child.length;p++){
      console.log(child)
      if (child[p].actionExt != "next" && child[p].actionExt !="doing" ){
        num ++;
      }
      console.log(num, child.length)
      this.setState({
        condition: true,
        percent: (num / child.length)*100
      })
    }
  }
}
//ç‚¹å‡»ç®­å¤´å±•å¼€å®¡æ‰¹èŠ‚ç‚¹ä¿¡æ¯æ—¶ï¼Œä¸åœ¨æ“ä½œåˆ—ä¸­å‡ºç°æŸ¥çœ‹è¿›åº¦çš„æ“ä½œ
export function actionRender1(title, rowData) {
  if(!rowData.children){
    return false;
  }
  return title;  // return false åˆ™ä¸æ˜¾ç¤º
 }
```

![æ•ˆæœæ¼”ç¤º](https://img.alicdn.com/imgextra/i4/O1CN01FwO3zm1Dhcy4fSFx5_!!6000000000248-2-tps-1524-706.png)

** ï¼ˆ6ï¼‰ å®ç°åˆ†é¡µå±•ç¤ºæ•°æ® **

![è¡¨æ ¼ç»„ä»¶ç»‘å®šåŠ¨ä½œ](https://img.alicdn.com/imgextra/i2/O1CN01ikr8Gd1z4mwEQNQMF_!!6000000006661-2-tps-1439-707.png)

> **è¯´æ˜ï¼š**
>
> - å‰ç½®æ¡ä»¶ï¼šè·å–æµç¨‹å®ä¾‹ ID çš„è¿œç¨‹æ•°æ®æºå†…åš didfetch æ•°æ®å¤„ç†ï¼Œå·²åœ¨ JS é¢æ¿å†…å®šä¹‰ timeshow æ–¹æ³•ã€‚
> - ä¸‹è¿°ä»£ç å¯ç›´æ¥å¤åˆ¶åœ¨ JS é¢æ¿å†…ï¼Œæ³¨æ„ï¼šéœ€è¦æ›¿æ¢ä¸‹æ‹‰å•é€‰ç»„ä»¶çš„å”¯ä¸€æ ‡è¯†.

```javascript
export function onFetchData(params) {
  //æ¸…ç©ºdataså˜é‡æ•°æ®æºï¼Œä¸æ¸…ç©ºæœ‰å¯èƒ½ä¼šé€ æˆç¿»é¡µæ—¶æ•°æ®å±•ç¤ºé”™è¯¯
  this.setState({
    datas: [],
  });

  // å¦‚æœæ˜¯æœç´¢çš„è¯ç¿»é¡µé‡ç½®åˆ° 1
  if (params.from === "search") {
    params.currentPage = 1;
  }

  //å®šä¹‰newvalueæ•°ç»„ï¼Œå­˜æ”¾è¡¨æ ¼æ•°æ®
  const newvalue = [];
  //é€šè¿‡APIæ–¹æ³•è·å–åˆ°ä¸‹æ‹‰ç»„ä»¶çš„valueå€¼ï¼Œä¹Ÿå°±æ˜¯formUuid
  const uuid = this.$("select_kto1v6f2").getValue();
  //é…ç½®è·å–å®ä¾‹idæ•°æ®æºå‚æ•°ï¼Œè·å–ç¿»é¡µåçš„ç¬¬params.currentPageé¡µæ•°æ®
  const param_1 = {
    formUuid: uuid,
    pageSize: 5,
    currentPage: params.currentPage,
  };
  this.dataSourceMap.getInstanceIds.load(param_1).then((response) => {
    let res = response.processInstanceId;
    for (let i = 0; i < res.length; i++) {
      const params = {
        processInstanceId: res[i],
      };
      this.dataSourceMap.getOperationRecords.load(params).then((content) => {
        const children = [];
        for (let item = 0; item < content.length; item++) {
          if (
            content[item].actionExt === "next" ||
            content[item].actionExt === "submit" ||
            content[item].actionExt === "doing"
          ) {
            if (content[item].showName === "é‡æ–°æäº¤") {
              this.setState({
                time: timeshow(
                  content[item].operateTime,
                  content[item - 1].operateTime
                ),
              });
              let children_data = {
                actionExt: content[item].actionExt,
                active: content[item].showName,
                active_name: content[item].operatorName,
                active_time: content[item].operateTime,
                time: state.time,
                onlyid: params.processInstanceId,
              };
              children.push(children_data);
            } else {
              let children_data = {
                actionExt: content[item].actionExt,
                active: content[item].showName,
                active_name: content[item].operatorName,
                active_time: content[item].operateTime,
                onlyid: params.processInstanceId,
              };
              children.push(children_data);
            }
          } else {
            this.setState({
              time: timeshow(
                content[item].operateTime,
                content[item - 1].operateTime
              ),
            });
            let children_data = {
              actionExt: content[item].actionExt,
              active: content[item].showName,
              active_name: content[item].operatorName,
              active_time: content[item].operateTime,
              time: state.time,
              onlyid: params.processInstanceId,
            };
            children.push(children_data);
          }
        }

        for (let j = 0; j < content.length; j++) {
          if (content[j].type === "TODO") {
            let data = {
              create_name: content[0].operatorName,
              create_time: content[0].operateTime,
              actionExt: content[j].actionExt,
              active: content[j].showName + "ï¼ˆå½“å‰ï¼‰",
              active_name: content[j].operatorName + "ï¼ˆå½“å‰ï¼‰",
              active_time: content[j].activeTime,
              children: children,
              onlyid: params.processInstanceId,
            };
            newvalue.push(data);
          }
        }

        if (content[content.length - 1].type === "HISTORY") {
          const num_end = content[content.length - 1].operateTime;
          const num_start = content[0].operateTime;

          this.setState({
            time: timeshow(num_end, num_start),
          });

          let data = {
            create_name: content[0].operatorName,
            create_time: content[0].operateTime,
            actionExt: "Completed",
            active: content[content.length - 1].showName + "(å·²å®Œæˆ)",
            active_name: content[content.length - 1].operatorName + "(å·²å®Œæˆ)",
            active_time: content[content.length - 1].operateTime,
            action: content[content.length - 1].actionExt,
            time: state.time,
            children: children,
            onlyid: params.processInstanceId,
          };
          newvalue.push(data);
        }
        //currentPageæ§åˆ¶é¡µç é€‰ä¸­ï¼ŒtotalCountæ§åˆ¶æ€»è®¡æ¡æ•°ï¼Œdataæ˜¯æ§åˆ¶æ•°æ®
        let result = {
          data: newvalue,
          totalCount: response.totalCount,
          currentPage: response.currentPage,
        };
        this.setState({
          datas: result,
        });
      });
    }
  });
}
```

![æ•ˆæœæ¼”ç¤º](https://img.alicdn.com/imgextra/i4/O1CN01ihK2v128lgZo3DRqk_!!6000000007973-1-tps-1256-729.gif)

** (6) é…ç½®åˆå§‹åŒ–æ—¶è¡¨æ ¼æç¤º **
![æ•ˆæœæ¼”ç¤º](https://img.alicdn.com/imgextra/i4/O1CN01wAXsgn1hKfaTWa1s9_!!6000000004259-2-tps-1439-434.png)

> **è¯´æ˜ï¼š**
>
> ä¸‹è¿°ä»£ç å¯ç›´æ¥å¤åˆ¶åœ¨ JS é¢æ¿å†….

```javascript
export function didMount() {
  document.getElementsByClassName("next-table-empty")[0].innerHTML =
    "è¯·é€‰æ‹©æµç¨‹é¡µé¢åç§°";
}
```

## åœ¨çº¿è¯•ç©

åœ¨çº¿ä½“éªŒè¯·ç§»æ­¥å¼€å‘è€…ä¸­å¿ƒ ğŸ‘‰ [å•åº”ç”¨å…¨æµç¨‹æ•ˆç‡ç›‘æ§](https://www.aliwork.com/developer/total-process)
